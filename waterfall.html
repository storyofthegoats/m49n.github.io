<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pokémon Waterfall · m49n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #020617;
      --fg: #e5e7eb;
      --accent: #4af626;
      --accent-soft: #0f172a;
      --accent-strong: #4af626;
      --muted: #64748b;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #020617 0, #000 55%, #020617 100%);
      color: var(--fg);
      overflow: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 0.75rem 1.5rem 0.5rem;
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 1rem;
      z-index: 10;
      pointer-events: none;
    }

    header h1 {
      font-size: 0.9rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--muted);
      margin: 0;
      white-space: nowrap;
    }

    header span {
      font-size: 0.8rem;
      color: #475569;
      font-style: italic;
      white-space: nowrap;
    }

    #waterfall {
      flex: 1;
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 0.5rem 1.25rem 1.25rem;
      position: relative;
      isolation: isolate;
    }

    .column {
      flex: 0 1 360px;
      width: min(360px, 90vw);
      position: relative;
      overflow: hidden;
      mask-image: linear-gradient(
        to bottom,
        transparent 0,
        black 16%,
        black 84%,
        transparent 100%
      );
    }

    .track {
      position: absolute;
      top: -100%;
      left: 0;
      right: 0;
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      padding: 0 0.25rem;
      animation-name: scrollDown;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }

    .name {
      font-family: "IBM Plex Mono", "SFMono-Regular", Menlo, Consolas,
        "Liberation Mono", monospace;
      font-size: 0.85rem;
      line-height: 1.35;
      color: var(--accent);
      text-shadow:
        0 0 6px rgba(74, 246, 38, 0.3),
        0 0 14px rgba(12, 90, 35, 0.75);
      cursor: pointer;
      transition:
        color 140ms ease-out,
        transform 140ms ease-out,
        text-shadow 140ms ease-out,
        letter-spacing 140ms ease-out;
      white-space: nowrap;
      user-select: none;
      display: block;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 0.2rem;
    }

    .name:hover {
      color: #8bff6a;
      text-shadow:
        0 0 10px rgba(74, 246, 38, 0.8),
        0 0 18px rgba(12, 90, 35, 1);
      transform: scale(1.05);
      letter-spacing: 0.04em;
    }

    body.paused .track {
      animation-play-state: paused;
    }

    /* Simpler, always-visible scroll:
       The track starts just above the column (-100%) and moves to far below (+100%),
       so the whole thing passes through the visible area. */
    @keyframes scrollDown {
      0% {
        transform: translateY(0);
      }
      100% {
        transform: translateY(200%);
      }
    }

    /* Focus card overlay */

    #focus-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 20;
    }

    #focus-overlay.visible {
      display: flex;
    }

    #focus-backdrop {
      position: absolute;
      inset: 0;
    }

    #focus-card {
      position: relative;
      z-index: 1;
      background: radial-gradient(circle at top left, #0f172a, #020617);
      border-radius: 1.25rem;
      border: 1px solid rgba(148, 163, 184, 0.45);
      box-shadow:
        0 24px 60px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(15, 23, 42, 1);
      padding: 1.5rem 1.75rem 1.4rem;
      max-width: 420px;
      width: min(420px, 90vw);
      color: var(--fg);
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    #focus-close {
      position: absolute;
      top: 0.75rem;
      right: 0.85rem;
      font-size: 0.85rem;
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      border-radius: 999px;
      padding: 0.2rem 0.55rem;
      border: 1px solid rgba(51, 65, 85, 0.9);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    #focus-close span {
      font-size: 0.9em;
    }

    #focus-name {
      font-size: 1.6rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      margin: 0;
      color: var(--accent-strong);
      text-shadow:
        0 0 12px rgba(56, 189, 248, 0.4),
        0 0 24px rgba(15, 23, 42, 1);
    }

    #focus-tagline {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--muted);
    }

    #focus-blurb {
      font-size: 0.9rem;
      line-height: 1.5;
      color: #e2e8f0;
    }

    #focus-meta {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      font-size: 0.75rem;
      color: #94a3b8;
      border-top: 1px dashed rgba(51, 65, 85, 0.9);
      padding-top: 0.5rem;
      margin-top: 0.25rem;
    }

    #focus-meta-stats {
      display: flex;
      gap: 0.75rem;
      align-items: center;
      flex-wrap: wrap;
    }

    #focus-meta span {
      white-space: nowrap;
    }

    #focus-meta-id {
      position: relative;
      width: 100%;
      overflow: hidden;
    }

    #focus-meta-id .marquee-track {
      display: inline-flex;
      gap: 1.5rem;
      animation: focus-marquee 12s linear infinite;
    }

    #focus-meta-id .marquee-segment {
      white-space: nowrap;
    }

    @keyframes focus-marquee {
      from {
        transform: translateX(0);
      }
      to {
        transform: translateX(-50%);
      }
    }

    @media (max-width: 640px) {
      header {
        padding-inline: 1rem;
      }
      #waterfall {
        padding-inline: 0.75rem;
      }
      .name {
        font-size: 0.8rem;
      }
      #focus-card {
        padding-inline: 1.25rem;
      }
      #focus-name {
        font-size: 1.35rem;
        letter-spacing: 0.12em;
      }
      #focus-tagline {
        font-size: 0.75rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>POKÉMON WATERFALL</h1>
    <span>click a name to surface it from the noise</span>
  </header>

  <main id="waterfall"></main>

  <!-- Focus overlay -->
  <div id="focus-overlay">
    <div id="focus-backdrop"></div>
    <article id="focus-card">
      <button id="focus-close">
        <span>esc</span> ✕
      </button>
      <h2 id="focus-name">MISSINGNO</h2>
      <div id="focus-tagline">unstable entry · m49n field notes</div>
      <p id="focus-blurb"></p>
      <div id="focus-meta">
        <div id="focus-meta-stats">
          <span id="focus-meta-length"></span>
          <span id="focus-meta-syllables"></span>
        </div>
        <div id="focus-meta-id"></div>
      </div>
    </article>
  </div>

  <script>
    /* Full National Pokédex list for the waterfall. */

    const POKEMON_STRING = `
      Bulbasaur. Ivysaur. Venusaur. Charmander. Charmeleon. Charizard. Squirtle. Wartortle. Blastoise. Caterpie. Metapod. Butterfree.
      Weedle. Kakuna. Beedrill. Pidgey. Pidgeotto. Pidgeot. Rattata. Raticate. Spearow. Fearow. Ekans. Arbok.
      Pikachu. Raichu. Sandshrew. Sandslash. Nidoran♀. Nidorina. Nidoqueen. Nidoran♂. Nidorino. Nidoking. Clefairy. Clefable.
      Vulpix. Ninetales. Jigglypuff. Wigglytuff. Zubat. Golbat. Oddish. Gloom. Vileplume. Paras. Parasect. Venonat.
      Venomoth. Diglett. Dugtrio. Meowth. Persian. Psyduck. Golduck. Mankey. Primeape. Growlithe. Arcanine. Poliwag.
      Poliwhirl. Poliwrath. Abra. Kadabra. Alakazam. Machop. Machoke. Machamp. Bellsprout. Weepinbell. Victreebel. Tentacool.
      Tentacruel. Geodude. Graveler. Golem. Ponyta. Rapidash. Slowpoke. Slowbro. Magnemite. Magneton. Farfetch’d. Doduo.
      Dodrio. Seel. Dewgong. Grimer. Muk. Shellder. Cloyster. Gastly. Haunter. Gengar. Onix. Drowzee.
      Hypno. Krabby. Kingler. Voltorb. Electrode. Exeggcute. Exeggutor. Cubone. Marowak. Hitmonlee. Hitmonchan. Lickitung.
      Koffing. Weezing. Rhyhorn. Rhydon. Chansey. Tangela. Kangaskhan. Horsea. Seadra. Goldeen. Seaking. Staryu.
      Starmie. Mr. Mime. Scyther. Jynx. Electabuzz. Magmar. Pinsir. Tauros. Magikarp. Gyarados. Lapras.
      Ditto. Eevee. Vaporeon. Jolteon. Flareon. Porygon. Omanyte. Omastar. Kabuto. Kabutops. Aerodactyl. Snorlax.
      Articuno. Zapdos. Moltres. Dratini. Dragonair. Dragonite. Mewtwo. Mew. Chikorita. Bayleef. Meganium. Cyndaquil.
      Quilava. Typhlosion. Totodile. Croconaw. Feraligatr. Sentret. Furret. Hoothoot. Noctowl. Ledyba. Ledian. Spinarak.
      Ariados. Crobat. Chinchou. Lanturn. Pichu. Cleffa. Igglybuff. Togepi. Togetic. Natu. Xatu. Mareep.
      Flaaffy. Ampharos. Bellossom. Marill. Azumarill. Sudowoodo. Politoed. Hoppip. Skiploom. Jumpluff. Aipom. Sunkern.
      Sunflora. Yanma. Wooper. Quagsire. Espeon. Umbreon. Murkrow. Slowking. Misdreavus. Unown. Wobbuffet. Girafarig.
      Pineco. Forretress. Dunsparce. Gligar. Steelix. Snubbull. Granbull. Qwilfish. Scizor. Shuckle. Heracross. Sneasel.
      Teddiursa. Ursaring. Slugma. Magcargo. Swinub. Piloswine. Corsola. Remoraid. Octillery. Delibird. Mantine. Skarmory.
      Houndour. Houndoom. Kingdra. Phanpy. Donphan. Porygon2. Stantler. Smeargle. Tyrogue. Hitmontop. Smoochum. Elekid.
      Magby. Miltank. Blissey. Raikou. Entei. Suicune. Larvitar. Pupitar. Tyranitar. Lugia. Ho-Oh. Celebi.
      Treecko. Grovyle. Sceptile. Torchic. Combusken. Blaziken. Mudkip. Marshtomp. Swampert. Poochyena. Mightyena. Zigzagoon.
      Linoone. Wurmple. Silcoon. Beautifly. Cascoon. Dustox. Lotad. Lombre. Ludicolo. Seedot. Nuzleaf. Shiftry.
      Taillow. Swellow. Wingull. Pelipper. Ralts. Kirlia. Gardevoir. Surskit. Masquerain. Shroomish. Breloom. Slakoth.
      Vigoroth. Slaking. Nincada. Ninjask. Shedinja. Whismur. Loudred. Exploud. Makuhita. Hariyama. Azurill. Nosepass.
      Skitty. Delcatty. Sableye. Mawile. Aron. Lairon. Aggron. Meditite. Medicham. Electrike. Manectric. Plusle.
      Minun. Volbeat. Illumise. Roselia. Gulpin. Swalot. Carvanha. Sharpedo. Wailmer. Wailord. Numel. Camerupt.
      Torkoal. Spoink. Grumpig. Spinda. Trapinch. Vibrava. Flygon. Cacnea. Cacturne. Swablu. Altaria. Zangoose.
      Seviper. Lunatone. Solrock. Barboach. Whiscash. Corphish. Crawdaunt. Baltoy. Claydol. Lileep. Cradily. Anorith.
      Armaldo. Feebas. Milotic. Castform. Kecleon. Shuppet. Banette. Duskull. Dusclops. Tropius. Chimecho. Absol.
      Wynaut. Snorunt. Glalie. Spheal. Sealeo. Walrein. Clamperl. Huntail. Gorebyss. Relicanth. Luvdisc. Bagon.
      Shelgon. Salamence. Beldum. Metang. Metagross. Regirock. Regice. Registeel. Latias. Latios. Kyogre. Groudon.
      Rayquaza. Jirachi. Deoxys. Turtwig. Grotle. Torterra. Chimchar. Monferno. Infernape. Piplup. Prinplup. Empoleon.
      Starly. Staravia. Staraptor. Bidoof. Bibarel. Kricketot. Kricketune. Shinx. Luxio. Luxray. Budew. Roserade.
      Cranidos. Rampardos. Shieldon. Bastiodon. Burmy. Wormadam. Mothim. Combee. Vespiquen. Pachirisu. Buizel. Floatzel.
      Cherubi. Cherrim. Shellos. Gastrodon. Ambipom. Drifloon. Drifblim. Buneary. Lopunny. Mismagius. Honchkrow. Glameow.
      Purugly. Chingling. Stunky. Skuntank. Bronzor. Bronzong. Bonsly. Mime Jr. Happiny. Chatot. Spiritomb. Gible.
      Gabite. Garchomp. Munchlax. Riolu. Lucario. Hippopotas. Hippowdon. Skorupi. Drapion. Croagunk. Toxicroak. Carnivine.
      Finneon. Lumineon. Mantyke. Snover. Abomasnow. Weavile. Magnezone. Lickilicky. Rhyperior. Tangrowth. Electivire. Magmortar.
      Togekiss. Yanmega. Leafeon. Glaceon. Gliscor. Mamoswine. Porygon-Z. Gallade. Probopass. Dusknoir. Froslass. Rotom.
      Uxie. Mesprit. Azelf. Dialga. Palkia. Heatran. Regigigas. Giratina. Cresselia. Phione. Manaphy. Darkrai.
      Shaymin. Arceus. Victini. Snivy. Servine. Serperior. Tepig. Pignite. Emboar. Oshawott. Dewott. Samurott.
      Patrat. Watchog. Lillipup. Herdier. Stoutland. Purrloin. Liepard. Pansage. Simisage. Pansear. Simisear. Panpour.
      Simipour. Munna. Musharna. Pidove. Tranquill. Unfezant. Blitzle. Zebstrika. Roggenrola. Boldore. Gigalith. Woobat.
      Swoobat. Drilbur. Excadrill. Audino. Timburr. Gurdurr. Conkeldurr. Tympole. Palpitoad. Seismitoad. Throh. Sawk.
      Sewaddle. Swadloon. Leavanny. Venipede. Whirlipede. Scolipede. Cottonee. Whimsicott. Petilil. Lilligant. Basculin. Sandile.
      Krokorok. Krookodile. Darumaka. Darmanitan. Maractus. Dwebble. Crustle. Scraggy. Scrafty. Sigilyph. Yamask. Cofagrigus.
      Tirtouga. Carracosta. Archen. Archeops. Trubbish. Garbodor. Zorua. Zoroark. Minccino. Cinccino. Gothita. Gothorita.
      Gothitelle. Solosis. Duosion. Reuniclus. Ducklett. Swanna. Vanillite. Vanillish. Vanilluxe. Deerling. Sawsbuck. Emolga.
      Karrablast. Escavalier. Foongus. Amoonguss. Frillish. Jellicent. Alomomola. Joltik. Galvantula. Ferroseed. Ferrothorn. Klink.
      Klang. Klinklang. Tynamo. Eelektrik. Eelektross. Elgyem. Beheeyem. Litwick. Lampent. Chandelure. Axew. Fraxure.
      Haxorus. Cubchoo. Beartic. Cryogonal. Shelmet. Accelgor. Stunfisk. Mienfoo. Mienshao. Druddigon. Golett. Golurk.
      Pawniard. Bisharp. Bouffalant. Rufflet. Braviary. Vullaby. Mandibuzz. Heatmor. Durant. Deino. Zweilous. Hydreigon.
      Larvesta. Volcarona. Cobalion. Terrakion. Virizion. Tornadus. Thundurus. Reshiram. Zekrom. Landorus. Kyurem. Keldeo.
      Meloetta. Genesect. Chespin. Quilladin. Chesnaught. Fennekin. Braixen. Delphox. Froakie. Frogadier. Greninja. Bunnelby.
      Diggersby. Fletchling. Fletchinder. Talonflame. Scatterbug. Spewpa. Vivillon. Litleo. Pyroar. Flabébé. Floette. Florges.
      Skiddo. Gogoat. Pancham. Pangoro. Furfrou. Espurr. Meowstic. Honedge. Doublade. Aegislash. Spritzee. Aromatisse.
      Swirlix. Slurpuff. Inkay. Malamar. Binacle. Barbaracle. Skrelp. Dragalge. Clauncher. Clawitzer. Helioptile. Heliolisk.
      Tyrunt. Tyrantrum. Amaura. Aurorus. Sylveon. Hawlucha. Dedenne. Carbink. Goomy. Sliggoo. Goodra. Klefki.
      Phantump. Trevenant. Pumpkaboo. Gourgeist. Bergmite. Avalugg. Noibat. Noivern. Xerneas. Yveltal. Zygarde. Diancie.
      Hoopa. Volcanion. Rowlet. Dartrix. Decidueye. Litten. Torracat. Incineroar. Popplio. Brionne. Primarina. Pikipek.
      Trumbeak. Toucannon. Yungoos. Gumshoos. Grubbin. Charjabug. Vikavolt. Crabrawler. Crabominable. Oricorio. Cutiefly. Ribombee.
      Rockruff. Lycanroc. Wishiwashi. Mareanie. Toxapex. Mudbray. Mudsdale. Dewpider. Araquanid. Fomantis. Lurantis. Morelull.
      Shiinotic. Salandit. Salazzle. Stufful. Bewear. Bounsweet. Steenee. Tsareena. Comfey. Oranguru. Passimian. Wimpod.
      Golisopod. Sandygast. Palossand. Pyukumuku. Type: Null. Silvally. Minior. Komala. Turtonator. Togedemaru. Mimikyu. Bruxish.
      Drampa. Dhelmise. Jangmo-o. Hakamo-o. Kommo-o. Tapu Koko. Tapu Lele. Tapu Bulu. Tapu Fini. Cosmog. Cosmoem. Solgaleo.
      Lunala. Nihilego. Buzzwole. Pheromosa. Xurkitree. Celesteela. Kartana. Guzzlord. Necrozma. Magearna. Marshadow. Poipole.
      Naganadel. Stakataka. Blacephalon. Zeraora. Meltan. Melmetal. Grookey. Thwackey. Rillaboom. Scorbunny. Raboot. Cinderace.
      Sobble. Drizzile. Inteleon. Skwovet. Greedent. Rookidee. Corvisquire. Corviknight. Blipbug. Dottler. Orbeetle. Nickit.
      Thievul. Gossifleur. Eldegoss. Wooloo. Dubwool. Chewtle. Drednaw. Yamper. Boltund. Rolycoly. Carkol. Coalossal.
      Applin. Flapple. Appletun. Silicobra. Sandaconda. Cramorant. Arrokuda. Barraskewda. Toxel. Toxtricity. Sizzlipede. Centiskorch.
      Clobbopus. Grapploct. Sinistea. Polteageist. Hatenna. Hattrem. Hatterene. Impidimp. Morgrem. Grimmsnarl. Obstagoon. Perrserker.
      Cursola. Sirfetch’d. Mr. Rime. Runerigus. Milcery. Alcremie. Falinks. Pincurchin. Snom. Frosmoth. Stonjourner.
      Eiscue. Indeedee. Morpeko. Cufant. Copperajah. Dracozolt. Arctozolt. Dracovish. Arctovish. Duraludon. Dreepy. Drakloak.
      Dragapult. Zacian. Zamazenta. Eternatus. Kubfu. Urshifu. Zarude. Regieleki. Regidrago. Glastrier. Spectrier. Calyrex.
      Sprigatito. Floragato. Meowscarada. Fuecoco. Crocalor. Skeledirge. Quaxly. Quaxwell. Quaquaval. Lechonk. Oinkologne. Tarountula.
      Spidops. Nymble. Lokix. Pawmi. Pawmo. Pawmot. Tandemaus. Maushold. Fidough. Dachsbun. Smoliv. Dolliv.
      Arboliva. Squawkabilly. Nacli. Naclstack. Garganacl. Charcadet. Armarouge. Ceruledge. Tadbulb. Bellibolt. Wattrel. Kilowattrel.
      Maschiff. Mabosstiff. Shroodle. Grafaiai. Bramblin. Brambleghast. Toedscool. Toedscruel. Klawf. Capsakid. Scovillain. Rellor.
      Rabsca. Flittle. Espathra. Tinkatink. Tinkatuff. Tinkaton. Wiglett. Wugtrio. Bombirdier. Finizen. Palafin. Varoom.
      Revavroom. Cyclizar. Orthworm. Glimmet. Glimmora. Greavard. Houndstone. Flamigo. Cetoddle. Cetitan. Veluza. Dondozo.
      Tatsugiri. Annihilape. Clodsire. Farigiraf. Dudunsparce. Kingambit. Great Tusk. Scream Tail. Brute Bonnet. Flutter Mane. Slither Wing. Sandy Shocks.
      Iron Treads. Iron Bundle. Iron Hands. Iron Jugulis. Iron Moth. Iron Thorns. Frigibax. Arctibax. Baxcalibur. Gimmighoul. Gholdengo. Wo-Chien.
      Chien-Pao. Ting-Lu. Chi-Yu. Roaring Moon. Iron Valiant. Koraidon. Miraidon. Walking Wake. Iron Leaves. Dipplin. Poltchageist. Sinistcha.
      Okidogi. Munkidori. Fezandipiti. Ogerpon. Archaludon. Hydrapple. Gouging Fire. Raging Bolt. Iron Boulder. Iron Crown. Terapagos. Pecharunt.
    `.trim();
    // ^^^ Replace everything between the backticks with your full list.
    // ^^^ Replace everything between the backticks with your full list.

    // --- Parse names ---
    const pokemonNames = POKEMON_STRING
      .split(".")
      .map((n) => n.trim())
      .filter(Boolean);

    // tiny fallback in case the string somehow ends up empty
    if (!pokemonNames.length) {
      pokemonNames.push(
        "Bulbasaur",
        "MissingNo",
        "Mattmon",
        "Goatachu",
        "Sleeplax"
      );
    }

    const waterfall = document.querySelector("#waterfall");
    const NUM_COLUMNS = 1;

    function pickRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function createColumn() {
      const col = document.createElement("div");
      col.className = "column";

      const baseDuration = 22 + Math.random() * 12; // 22–34s
      const offset = Math.random(); // random starting position

      for (let copy = 0; copy < 2; copy++) {
        const track = document.createElement("div");
        track.className = "track";
        track.style.animationDuration = `${baseDuration.toFixed(2)}s`;
        const phase = (offset + copy * 0.5) % 1;
        track.style.animationDelay = `-${(baseDuration * phase).toFixed(2)}s`;

        const itemsInTrack = 120 + Math.floor(Math.random() * 60); // 120–180 names

        for (let i = 0; i < itemsInTrack; i++) {
          const name = document.createElement("div");
          name.className = "name";
          name.textContent = pickRandom(pokemonNames);
          name.addEventListener("click", (event) => {
            event.stopPropagation();
            focusOnName(name.textContent);
          });
          track.appendChild(name);
        }

        col.appendChild(track);
      }

      return col;
    }

    function buildWaterfall() {
      waterfall.innerHTML = "";
      for (let i = 0; i < NUM_COLUMNS; i++) {
        waterfall.appendChild(createColumn(i));
      }
    }

    // --- Focus overlay logic ---

    const overlay = document.querySelector("#focus-overlay");
    const focusNameEl = document.querySelector("#focus-name");
    const focusTaglineEl = document.querySelector("#focus-tagline");
    const focusBlurbEl = document.querySelector("#focus-blurb");
    const focusMetaLength = document.querySelector("#focus-meta-length");
    const focusMetaSyllables = document.querySelector("#focus-meta-syllables");
    const focusMetaId = document.querySelector("#focus-meta-id");
    const focusBackdrop = document.querySelector("#focus-backdrop");
    const focusClose = document.querySelector("#focus-close");

    const moodAdjectives = [
      "restless",
      "low-grade feral",
      "cosmically confused",
      "mildly radioactive",
      "chronically curious",
      "liminal-space",
      "suburban myth-tier",
      "overcaffeinated",
      "borderline legendary",
      "sleep-deprived"
    ];

    const behaviorPhrases = [
      "loiters in loading screens long after the game has closed",
      "appears only in autosave glitches and corrupted memory cards",
      "tends to evolve when nobody is emotionally prepared",
      "quietly rearranges the icons on your desktop while you sleep",
      "lurks in unfinished lists and abandoned spreadsheets",
      "is rumored to power obsolete handheld consoles at 3 a.m.",
      "only battles opponents who forgot why they opened their browser",
      "treats bug-reports as enrichment activities",
      "feeds on unplayed side-quests and half-built web projects",
      "appears whenever you say 'I’ll fix that later' three times in a row"
    ];

    const domainPhrases = [
      "digital folklore",
      "glitch ecology",
      "liminal UI studies",
      "late-night archive maintenance",
      "chaotic neutral documentation",
      "dream-logic taxonomy",
      "browser tab anthropology",
      "personal myth-keeping",
      "unnecessary internal tools",
      "micro-myth generation"
    ];

    function countSyllablesFromName(name) {
      const cleaned = name.toLowerCase().replace(/[^a-z]/g, "");
      const matches = cleaned.match(/[aeiouy]+/g);
      return matches ? matches.length : 1;
    }

    function generateTagline() {
      const domain = pickRandom(domainPhrases).toUpperCase();
      const mode = Math.random() > 0.5 ? "field notes" : "noncanonical entry";
      return `${domain} · ${mode}`;
    }

    function generateBlurb(name) {
      const mood = pickRandom(moodAdjectives);
      const behavior = pickRandom(behaviorPhrases);
      const domain = pickRandom(domainPhrases);

      return [
        `${name} is a ${mood} presence in the wider ecosystem of ${domain}.`,
        behavior.charAt(0).toUpperCase() + behavior.slice(1) + ".",
        `Researchers still aren’t sure if it’s a real Pokémon, a UI bug, or a note to self that accidentally learned how to walk.`
      ].join(" ");
    }

    function setTickerText(element, text) {
      const track = document.createElement("div");
      track.className = "marquee-track";

      for (let i = 0; i < 3; i++) {
        const segment = document.createElement("span");
        segment.className = "marquee-segment";
        segment.textContent = text;
        track.appendChild(segment);
      }

      element.innerHTML = "";
      element.appendChild(track);
    }

    function focusOnName(name) {
      document.body.classList.add("paused");
      overlay.classList.add("visible");

      focusNameEl.textContent = name;

      focusTaglineEl.textContent = generateTagline();
      focusBlurbEl.textContent = generateBlurb(name);

      const length = name.replace(/\s+/g, "").length;
      const syllables = countSyllablesFromName(name);
      const id =
        pokemonNames.indexOf(name) !== -1
          ? pokemonNames.indexOf(name) + 1
          : "???";

      focusMetaLength.textContent = `letters: ${length}`;
      focusMetaSyllables.textContent = `syllables (approx): ${syllables}`;
      const idString =
        typeof id === "number" ? `dex-ish index: #${id}` : `dex-ish index: ???`;

      setTickerText(focusMetaId, idString);
    }

    function closeFocus() {
      overlay.classList.remove("visible");
      document.body.classList.remove("paused");
    }

    focusBackdrop.addEventListener("click", closeFocus);
    focusClose.addEventListener("click", closeFocus);

    document.addEventListener("keydown", (event) => {
      if (event.key === "Escape" && overlay.classList.contains("visible")) {
        closeFocus();
      }
    });

    // --- Initialize ---
    buildWaterfall();

    // gently rebuild on resize so column count keeps up
    let resizeTimeout;
    window.addEventListener("resize", () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(buildWaterfall, 500);
    });
  </script>
</body>
</html>
